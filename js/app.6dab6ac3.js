(function(e){function t(t){for(var s,r,i=t[0],c=t[1],l=t[2],d=0,p=[];d<i.length;d++)r=i[d],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&p.push(o[r][0]),o[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);u&&u(t);while(p.length)p.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],s=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(s=!1)}s&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var s={},o={app:0},a=[];function r(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=s,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/v2_sound_classification_js/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"03f8":function(e,t,n){},"05c6":function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"export-model"},[n("div",{staticClass:"model-property model-property-name b"},[e._v(" "+e._s(e.model.name)+" ")]),e.model.trained?n("div",{staticClass:"model-property model-property-stats"},[e._v(" "+e._s(e.model.epochsTrained)+" epochs trained, acc: "+e._s(e.roundTo(e.model.acc,4))+", loss: "+e._s(e.roundTo(e.model.loss,4))+" ")]):e._e(),n("div",{staticClass:"btn",on:{click:e.exportModel}},[e._v(" export model ")])])},o=[],a=n("58f7"),r=a["a"],i=(n("b674"),n("2877")),c=Object(i["a"])(r,s,o,!1,null,null,null);t["a"]=c.exports},"0e5f":function(e,t,n){},"0ee9":function(e,t,n){"use strict";var s=n("629e"),o=n.n(s);o.a},1:function(e,t){},"1b2e":function(e,t,n){"use strict";var s=n("d981"),o=n.n(s);o.a},"1bea":function(e,t,n){"use strict";var s=n("f13a"),o=n.n(s);o.a},2:function(e,t){},2195:function(e,t,n){"use strict";var s=n("684f"),o=n.n(s);o.a},"21c5":function(e,t,n){"use strict";var s=n("90bf"),o=n.n(s);o.a},"23a2":function(e,t,n){"use strict";(function(e){n("ace4"),n("d3b7"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("96cf");var s=n("1da1"),o=n("21a6"),a=n("2ab6"),r=n("7ad4"),i=n("05c6"),c=n("0b53");t["a"]={components:{UploadFileButton:a["a"],Terminal:r["a"],ExportModel:i["a"]},data:function(){return{output:[]}},computed:{models:function(){return this.$store.getters["models/getModels"]}},methods:{exportSounds:function(){var e=this.$store.getters["sounds/getAllSounds"];this.saveData(e,"sounds.blob")},saveData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data.blob";Object(o["saveAs"])(new Blob([JSON.stringify(e)]),t)},importSounds:function(e){var t=this;0!=e.length&&this.importData(e[0]).then((function(e){var n=JSON.parse(e);t.$store.dispatch("sounds/importSounds",{sounds:n,logFunction:function(e){return t.output.push(e)}})})).catch((function(e){return t.output.push(e)}))},importModel:function(t){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function s(){var o,a,r,i,l,u;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(0!=t.length){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,n.importData(t[0]);case 4:return o=s.sent,s.prev=5,a=JSON.parse(o),r=a.tfModelJson,i=JSON.parse(r),l=new Uint8Array(e.from(i.weightData,"base64")).buffer,s.next=12,c["c"](c["a"].fromMemory(i.modelTopology,i.weightSpecs,l));case 12:u=s.sent,n.$store.dispatch("models/importModel",{model:a,tfModel:u}),s.next=19;break;case 16:s.prev=16,s.t0=s["catch"](5),console.log("Error processign model");case 19:case"end":return s.stop()}}),s,null,[[5,16]])})))()},importData:function(e){return new Promise((function(t,n){var s=new FileReader;s.onload=function(e){t(e.target.result)};try{s.readAsText(e)}catch(o){n(o)}}))}}}}).call(this,n("b639").Buffer)},2453:function(e,t,n){"use strict";var s=n("cee4"),o=n.n(s);o.a},2862:function(e,t,n){},"2ab6":function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-file-component"},[n("div",{staticClass:"upload-btn-wrapper"},[n("div",{class:e.btnClass,on:{click:e.clickFileUpload}},[e._v(" "+e._s(e.btnText)+" ")]),n("input",{ref:"input",attrs:{type:"file",accept:e.accept,multiple:e.multiple},on:{change:function(t){return e.handleFiles()}}})])])},o=[],a={props:{accept:{type:String,default:"audio/*"},multiple:{type:Boolean,default:!0},btnClass:{type:String,default:"btn"},btnText:{type:String,default:"upload"}},data:function(){return{}},methods:{handleFiles:function(){var e=this.$refs["input"];null==e.files||e.files.length<1||this.$emit("files",e.files)},clickFileUpload:function(){var e=this.$refs["input"];e.click()}}},r=a,i=(n("21c5"),n("2877")),c=Object(i["a"])(r,s,o,!1,null,"4e46fbfa",null);t["a"]=c.exports},3:function(e,t){},"37e7":function(e,t,n){},4:function(e,t){},4678:function(e,t,n){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}o.keys=function(){return Object.keys(s)},o.resolve=a,e.exports=o,o.id="4678"},5:function(e,t){},5353:function(e,t,n){"use strict";var s=n("03f8"),o=n.n(s);o.a},"567d":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("side-menu"),n("status-message"),n("router-view",{staticClass:"router-content"})],1)},a=[],r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["side-menu color-off-white",e.collapsed?"collapsed":"showing"]},[n("div",{staticClass:"side-menu-button",on:{click:function(t){e.collapsed=!e.collapsed}}},[e.collapsed?n("menu-icon",{staticClass:"menu-icon"}):e._e(),e.collapsed?e._e():n("close-icon",{staticClass:"close-icon"})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:!e.collapsed,expression:"!collapsed"}],staticClass:"side-menu-catch-clicks",on:{click:function(t){e.collapsed=!0}}}),n("div",{staticClass:"side-menu-window theme-blue",style:e.windowStyle},[n("div",{staticClass:"side-menu-header view-title h4"},[e._v(" Sound classification js ")]),n("div",{staticClass:"side-menu-links"},[e._l(e.menuLinks,(function(t,s){return n("router-link",{key:s,staticClass:"menu-link",attrs:{to:t},nativeOn:{click:function(t){e.collapsed=!0}}},[e._v(e._s(t.name))])})),n("div",{staticClass:"side-menu-separator"}),n("div",{staticClass:"menu-link",on:{click:e.clearAll}},[e._v("Delete everything")])],2)])])},i=[],c=(n("4de4"),n("8aa8")),l=n("7eb5"),u={components:{MenuIcon:c["a"],CloseIcon:l["a"]},data:function(){return{menuWidthVw:70,maxMenuWidthPx:500,minMenuWidthPx:350,collapsed:!0,windowWidthPx:0}},computed:{windowStyle:function(){return{left:this.collapsed?"-".concat(this.menuWidthPx,"px"):"0",right:this.collapsed?"100vw":"".concat(this.windowWidthPx-this.menuWidthPx,"px")}},menuWidthPx:function(){var e=Math.min(.01*this.menuWidthVw*this.windowWidthPx,this.maxMenuWidthPx);return e<this.minMenuWidthPx?Math.min(this.windowWidthPx,this.minMenuWidthPx):e},menuLinks:function(){return this.$router.options.routes.filter((function(e){return e.showInMenu}))}},mounted:function(){this.$nextTick((function(){window.addEventListener("resize",this.getWindowWidth),this.getWindowWidth()}))},destroyed:function(){window.removeEventListener("resize",this.getWindowWidth)},methods:{getWindowWidth:function(){this.windowWidthPx=document.documentElement.clientWidth},clearAll:function(){this.collapsed=!0,this.$store.dispatch("clearAll")}}},d=u,p=(n("5353"),n("2877")),f=Object(p["a"])(d,r,i,!1,null,"07caf9ad",null),h=f.exports,m=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["status-message",e.message?"":"no-message"]},[e._v(" "+e._s(e.message||e.standardMessage)+" ")])},v=[],b="0.2.6",g={computed:{message:function(){return this.$store.getters["sounds/getDiskActivity"]},standardMessage:function(){return"v".concat(b," all changes saved")}}},y=g,_=(n("1b2e"),Object(p["a"])(y,m,v,!1,null,"67662e32",null)),w=_.exports,S={name:"Home",components:{SideMenu:h,StatusMessage:w},mounted:function(){this.$store.dispatch("loadAll")}},j=S,k=(n("5c0b"),Object(p["a"])(j,o,a,!1,null,null,null)),M=k.exports,C=n("8c4f"),x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sounds"},[n("top-tabs"),n("div",{staticClass:"vertical-split-holder"},[n("vertical-split",{attrs:{fraction:.6},scopedSlots:e._u([{key:"top",fn:function(){return[n("browser")]},proxy:!0},{key:"bottom",fn:function(){return[n("sound-inspector")]},proxy:!0}])})],1)],1)},P=[],T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vertical-split"},[n("div",{staticClass:"part top-part",style:e.topPartStyle},[e._t("top")],2),n("div",{staticClass:"divider",style:e.dividerStyle}),n("div",{staticClass:"part bottom-part",style:e.bottomPartStyle},[e._t("bottom")],2)])},L=[],A=(n("99af"),n("a9e3"),{props:{fraction:{default:.75,type:Number}},data:function(){return{dividerSizeRem:1}},computed:{topPartStyle:function(){return{height:"calc(".concat(100*this.fraction,"% - ").concat(.5*this.dividerSizeRem,"rem)")}},bottomPartStyle:function(){return{height:"calc(".concat(100*(1-this.fraction),"% - ").concat(.5*this.dividerSizeRem,"rem)")}},dividerStyle:function(){return{height:"".concat(this.dividerSizeRem,"rem")}}}}),O=A,$=(n("2195"),Object(p["a"])(O,T,L,!1,null,"6499e3e0",null)),E=$.exports,D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"browser text-left"},[n("div",{staticClass:"browser-labels"},[n("div",{staticClass:"browser-content"},[n("div",{staticClass:"browser-title b"},[e._v("labels ("+e._s(e.labelObjects.length)+")")]),n("item-list",{attrs:{items:e.labelObjects,"selected-item":e.labelObjectByValue(e.selectedLabel)},on:{select:e.selectLabel,delete:function(t){return e.deleteLabel(t.value)}}})],1),n("div",{staticClass:"browser-bottom-btns"},[n("div",{staticClass:"btn btn-sm",on:{click:e.newLabel}},[e._v("new label")])])]),n("div",{staticClass:"browser-sounds"},[n("div",{staticClass:"browser-content"},[n("div",{staticClass:"browser-title b"},[e._v(" "+e._s(e.selectedLabel||"unlabeled")+" sounds ("+e._s(e.sounds.length)+" of "+e._s(e.allSounds.length)+" total) ")]),n("item-list",{attrs:{items:e.sounds,"selected-item":e.selectedSound},on:{select:e.selectSound,delete:e.deleteSound}})],1),n("div",{staticClass:"browser-bottom-btns"},[n("upload-sound-button",{attrs:{"btn-class":"btn btn-sm"},on:{sound:e.uploadSound}}),n("record-audio-button",{attrs:{"btn-class":"btn btn-sm","selected-label":e.selectedLabel},on:{sound:e.uploadSound}})],1)])])},I=[],R=(n("7db0"),n("d81d"),n("5530")),F=n("2909"),z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("upload-file-button",{attrs:{multiple:e.multiple,"btn-class":e.btnClass,accept:"audio/*"},on:{files:e.handleFiles}})},B=[],U=(n("4160"),n("b0c0"),n("2ca0"),n("159b"),n("2ab6")),W={components:{UploadFileButton:U["a"]},props:{btnClass:{type:String,default:"btn"},multiple:{type:Boolean,default:!0},returnDataUrl:{type:Boolean,default:!0}},methods:{handleFiles:function(e){var t=this;e.forEach((function(e){console.log("got file: ",e),e.type.startsWith("audio/")?t.returnDataUrl?t.loadSound(e):t.$emit("sound",e):console.log("not audio")}))},loadSound:function(e){var t=this,n=new FileReader;n.onload=function(n){t.$emit("sound",{name:e.name,type:e.type,file:n.target.result})},n.readAsDataURL(e)}}},q=W,N=Object(p["a"])(q,z,B,!1,null,null,null),V=N.exports,Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"record-audio-button"},[n("div",{staticClass:"btn btn-sm",on:{click:function(t){e.displayRecorder=!0}}},[e._v("record")]),e.displayRecorder?n("audio-recorder",{attrs:{"selected-label":e.selectedLabel},on:{close:function(t){e.displayRecorder=!1},sound:e.getSound}}):e._e()],1)},H=[],J=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"audio-recorder popup"},[n("div",{staticClass:"audio-recorder-content"},[n("div",{staticClass:"audio-recorder-title b"},[e._v("record audio")]),n("div",{staticClass:"audio-recorder-msg"},[e._v(" for label: "+e._s(e.selectedLabel||"unlabeled")+" ")]),e.supported?[n("div",{staticClass:"audio-recorder-rec-btns"},[e.recording?n("div",{staticClass:"btn",on:{click:e.stop}},[e._v("stop")]):n("div",{staticClass:"btn",on:{click:e.record}},[e._v("record")])]),n("div",{staticClass:"audio-recorder-time"},[e._v(" "+e._s(e.timePassedFormatted)+" ")]),!e.recording&&e.lastRecordingSound?n("div",{staticClass:"audio-recorder-new-btns"},[n("audio",{attrs:{controls:"",src:e.lastRecordingSound.file}}),n("div",{staticClass:"btn",on:{click:e.saveAndNew}},[e._v("save & new")]),n("div",{staticClass:"btn",on:{click:e.saveAndQuit}},[e._v("save & close")])]):e._e(),e.recording?e._e():n("div",{staticClass:"audio-recorder-quit-btns"},[e.lastRecordingSound?n("div",{staticClass:"btn",on:{click:e.newRecording}},[e._v(" discard & new ")]):e._e(),e.lastRecordingSound?n("div",{staticClass:"btn",on:{click:e.quit}},[e._v(" discard & close ")]):n("div",{staticClass:"btn",on:{click:e.quit}},[e._v("quit")])])]:[e.stillWaiting?n("div",{staticClass:"audio-recordr-msg"},[e._v(" Waiting for audio recording permission... ")]):n("div",{staticClass:"audio-recordr-msg"},[e._v(" Audio recording is not supported in this browser or permission is denied. Make sure you allow access to the microphone or try a different browser. ")]),n("div",{staticClass:"btn",on:{click:e.quit}},[e._v("close")])]],2)])},Q=[],G=(n("c975"),n("fb6a"),n("c19f"),n("ace4"),n("aff5"),n("d3b7"),n("ac1f"),n("1276"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("e295")),X=n.n(G),K={getRecorder:function(){var e={audio:!0};return new Promise((function(t,n){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)navigator.mediaDevices.getUserMedia(e).then((function(e){return t(e)})).catch((function(e){return n(e)}));else if(navigator.webkitGetUserMedia||navigator.mozGetUserMedia){var s=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;s.call(navigator,e,t,n)}else n(new Error("navigator.mediaDevices.getUserMedia is not supported."))}))},analyzeSpectrogram:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:512,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:40,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return e/10};X.a.numberOfMFCCCoefficients=n,X.a.bufferSize=t;for(var o=e.getChannelData(0),a=o.length,r=Math.floor(a/t),i=[],c=0;c<r;c++){var l=o.slice(c*t,(c+1)*t),u=X.a.extract(["mfcc"],l).mfcc;u=u.map((function(e){return Math.min(1,Math.max(s(e),0))})),i.push(u)}return i},fileToAudioBuffer:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:22050;return new Promise((function(n,s){var o=new FileReader;o.onload=function(e){var o=e.target.result,a=window.AudioContext||window.webkitAudioContext,r=new a({sampleRate:t});r.decodeAudioData(o,(function(e){return n(e)}),(function(e){return s(e)}))},o.readAsArrayBuffer(e)}))},dataURIToAudioBuffer:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:22050;return new Promise((function(s,o){var a=t.dataURItoBlob(e),r=new FileReader;r.onload=function(e){var t=e.target.result,a=window.AudioContext||window.webkitAudioContext,r=new a({sampleRate:n});r.decodeAudioData(t,(function(e){return s(e)}),(function(e){return o(e)}))},r.readAsArrayBuffer(a)}))},dataURItoBlob:function(e){for(var t=e.split(","),n=t[0].split(":")[1].split(";")[0],s=atob(t[1]),o=new ArrayBuffer(s.length),a=new Uint8Array(o),r=0;r<s.length;r++)a[r]=s.charCodeAt(r);var i=new Blob([o],{type:n});return i},calculateMediaDuration:function(e){return new Promise((function(t,n){e.currentTime=Number.MAX_SAFE_INTEGER,e.ontimeupdate=function(){e.ontimeupdate=function(){},e.currentTime=.1,e.currentTime=0,t(e.duration)}}))}},Z=n("1eaa"),ee=n("c1df"),te=n.n(ee),ne=function(e){var t=new Date(1e3*e).toISOString().substr(11,8);return 0===t.indexOf("00:")?t.substr(3):t},se={props:{selectedLabel:{type:String,default:null}},data:function(){return{recorder:null,supported:!1,stillWaiting:!0,recording:!1,lastRecordingSound:null,tickIntervalId:null,timePassed:0}},computed:{timePassedFormatted:function(){return ne(this.timePassed)}},mounted:function(){var e=this;K.getRecorder().then((function(t){e.supported=!0,e.recorder=new Z["a"](t),e.recorder.addEventListener("dataavailable",e.processRecording)})).catch((function(t){e.supported=!1,e.stillWaiting=!1,alert(t)}))},methods:{processRecording:function(e){var t=this;this.recording=!1,window.clearInterval(this.tickIntervalId);var n=new FileReader;n.onload=function(n){console.log("done encoding."),t.lastRecordingSound={name:"recording "+te()().format("YYYY-MM-DD HH:mm:ss"),type:e.data.type,file:n.target.result}},console.log("start encoding..."),n.readAsDataURL(e.data)},record:function(){this.recording=!0,this.lastRecordingSound=null,this.timePassed=0,this.tickIntervalId=window.setInterval(this.tick,1e3),console.log("start recording..."),this.recorder.start()},stop:function(){console.log("stop recording."),"recording"==this.recorder.state&&this.recorder.stop()},tick:function(){this.timePassed++},saveAndNew:function(){this.saveRecording(),this.newRecording()},saveAndQuit:function(){this.saveRecording(),this.quit()},newRecording:function(){this.lastRecordingSound=null},saveRecording:function(){this.lastRecordingSound&&this.$emit("sound",this.lastRecordingSound)},quit:function(){this.recorder&&("recording"==this.recorder.state&&this.recorder.stop(),this.recorder.stream.getTracks().forEach((function(e){return e.stop()}))),this.$emit("close")}}},oe=se,ae=(n("658f"),Object(p["a"])(oe,J,Q,!1,null,"7b9b5426",null)),re=ae.exports,ie={components:{AudioRecorder:re},props:{selectedLabel:{type:String,default:null}},data:function(){return{displayRecorder:!1}},methods:{getSound:function(e){console.log("got sound, passing through..."),this.$emit("sound",e)}}},ce=ie,le=(n("cbc0"),Object(p["a"])(ce,Y,H,!1,null,"5f3d6ec4",null)),ue=le.exports,de=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"item-list scroll"},e._l(e.items,(function(t,s){return n("div",{key:s,class:["item-list-item",e.selectedItem==t?"selected":"not-selected"],on:{click:function(n){return e.selectItem(t)}}},[e._v(" "+e._s(t[e.displayProperty])+" "),t.noDelete?e._e():n("div",{staticClass:"item-delete",on:{click:function(n){return e.deleteItem(t,n)}}},[n("close",{attrs:{size:12}})],1)])})),0)},pe=[],fe={components:{Close:l["a"]},props:{items:{type:Array,default:function(){return[]}},selectedItem:{type:Object,default:null},displayProperty:{type:String,default:"name"}},methods:{selectItem:function(e){this.selectedItem!=e&&this.$emit("select",e)},deleteItem:function(e,t){console.log(t),t.stopImmediatePropagation(),this.$emit("delete",e)}}},he=fe,me=(n("fb0a"),Object(p["a"])(he,de,pe,!1,null,"5b24e9d2",null)),ve=me.exports,be={components:{UploadSoundButton:V,RecordAudioButton:ue,ItemList:ve},data:function(){return{selectedLabel:null,nullLabelObject:{name:"unlabeled (".concat(this.soundsByLabel(null).length,")"),value:null,noDelete:!0}}},computed:{labelObjects:function(){var e=this;return[this.nullLabelObject].concat(Object(F["a"])(this.$store.getters["sounds/getLabels"].map((function(t){return{name:"".concat(t," (").concat(e.soundsByLabel(t).length,")"),value:t}}))))},sounds:function(){return this.soundsByLabel(this.selectedLabel)},allSounds:function(){return this.$store.getters["sounds/getAllSounds"]},selectedSound:function(){return this.$store.getters["sounds/getSelectedSound"]}},methods:{newLabel:function(){var e=this;this.$store.dispatch("sounds/newLabel").then((function(t){return e.selectedLabel=t||e.selectedLabel}))},deleteLabel:function(e){this.$store.commit("sounds/deleteLabel",e),this.selectedLabel=null},selectLabel:function(e){this.selectedLabel=e.value,this.selectSound(null)},labelObjectByValue:function(e){return this.labelObjects.find((function(t){return t.value==e}))||this.nullLabelObject},uploadSound:function(e){this.$store.commit("sounds/addSound",Object(R["a"])({label:this.selectedLabel},e))},recordSound:function(){console.log("record")},deleteSound:function(e){this.$store.commit("sounds/deleteSound",e)},soundsByLabel:function(e){return this.$store.getters["sounds/getSoundsByLabel"](e)},selectSound:function(e){this.$store.commit("sounds/selectSound",e)}}},ge=be,ye=(n("1bea"),Object(p["a"])(ge,D,I,!1,null,null,null)),_e=ye.exports,we=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sound-inspector"},[null!=e.selectedSound?n("div",{staticClass:"sound-inspector-content"},[n("div",{staticClass:"sound-inspector-part left"},[n("div",{staticClass:"sound-property sound-label"},[n("div",{staticClass:"sound-property-label"},[e._v("label")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedSound.label,expression:"selectedSound.label"}],staticClass:"wide",on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.selectedSound,"label",t.target.multiple?n:n[0])},e.saveSounds]}},[n("option",{domProps:{value:null}},[e._v("unlabeled")]),e._l(e.labels,(function(t,s){return n("option",{key:s,domProps:{value:t}},[e._v(e._s(t))])}))],2)]),n("div",{staticClass:"sound-property sound-name"},[n("div",{staticClass:"sound-property-label"},[e._v("name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedSound.name,expression:"selectedSound.name"}],staticClass:"wide",domProps:{value:e.selectedSound.name},on:{change:e.saveSounds,input:function(t){t.target.composing||e.$set(e.selectedSound,"name",t.target.value)}}})])]),n("div",{staticClass:"sound-inspector-part right"},[e.noSoundFile?[n("div",{staticClass:"sound-property-label sound-player-msg"},[e._v(" no sound file ")])]:e.selectedSoundData?[n("div",{staticClass:"sound-property-label"},[e._v(" play ")]),e.useCustomAudioPlayer?[n("vue-audio",{staticClass:"sound-player",attrs:{file:e.selectedSoundData}})]:[n("audio",{attrs:{controls:"",src:e.selectedSoundData}})]]:[n("div",{staticClass:"sound-property-label sound-player-msg"},[e._v(" loading sound... ")])],n("div",{staticClass:"sound-property sound-datetime"},[n("span",{staticClass:"sound-property-label"},[e._v("added ")]),n("span",[e._v(e._s(e.selectedSound.datetime))])]),n("div",{staticClass:"sound-property sound-type"},[n("span",{staticClass:"sound-property-label"},[e._v("type: ")]),n("span",[e._v(e._s(e.selectedSound.type))])]),n("div",{staticClass:"sound-property sound-preprocessed"},[e.selectedSound.spectrograms?[n("span",{staticClass:"sound-property-label"},[e._v(e._s(e.selectedSound.spectrograms.length)+" spectrograms ")]),n("div",{staticClass:"spectrograms-holder"},e._l(e.selectedSound.spectrograms,(function(t,s){return n("img",{key:s,attrs:{src:e.spectrogramImage(t)}})})),0)]:[n("span",{staticClass:"sound-property-label"},[e._v("Not preprocessed ")]),n("div",{staticClass:"btn btn-sm",on:{click:function(t){return e.$router.push("/preprocess")}}},[e._v(" preprocess ")])]],2)],2)]):e._e()])},Se=[],je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.classes+"-wrapper"},[n("div",{class:e.classes+"__player"},[n("div",{class:e.classes+"__playback-time-wrapper",attrs:{title:"Time played : Total time"},on:{click:e.setPosition}},[n("div",{class:e.classes+"__playback-time-indicator",style:e.progressStyle})]),n("div",{class:e.classes+"__player-controls"},[n("a",{attrs:{title:"Stop"},on:{click:function(t){return e.stop()}}},[n("stop",{staticClass:"color-blue"})],1),n("a",{attrs:{title:"Play"},on:{click:function(t){return e.pause()}}},[n("play",{class:["color-blue",e.paused?"":"op-50"]})],1)]),n("div",{class:e.classes+"__time-display"},[n("span",{class:e.classes+"__playback-time-current"},[e._v(e._s(e.currentTime))]),n("span",{class:e.classes+"__playback-time-separator"}),n("span",{class:e.classes+"__playback-time-total"},[e._v(e._s(e.duration))])])]),n("audio",{ref:"audiofile",staticStyle:{display:"none"},attrs:{id:e.playerId,loop:e.innerLoop,src:e.file,preload:"auto"}})])},ke=[],Me=(n("25f0"),n("5319"),n("ec1b")),Ce=n("3e97"),xe=7.5,Pe="vue-sound",Te=function(){return"xxxxxxxx-xxxx-4xxx".replace(/[xy]/g,(function(e){var t,n;return n=16*Math.random()|0,t="x"===e?n:3&n|8,t.toString(16)}))},Le=function(e){try{var t=new Date(1e3*e).toISOString().substr(11,8);return 0===t.indexOf("00:")?t.substr(3):t}catch(n){console.warn("Error converting time value:",e),console.warn(n)}},Ae={name:"vue-audio",props:{file:{type:String,default:null},autoPlay:{type:Boolean,default:!1},loop:{type:Boolean,default:!1}},components:{Play:Me["a"],Stop:Ce["a"]},computed:{duration:function(){return console.log("computing duration",this.totalDuration),this.audio?Le(this.totalDuration):""},playerId:function(){return"player-"+this.uuid},classes:function(){return Pe}},data:function(){return{isMuted:!1,loaded:!1,playing:!1,paused:!0,progressStyle:"",currentTime:"00:00",uuid:"0",innerLoop:void 0,audio:void 0,totalDuration:0,hideVolumeSlider:!1,volumeValue:xe}},methods:{setPosition:function(e){var t=e.target;if(!this.paused&&"SPAN"!==e.target.tagName){var n=t.getBoundingClientRect(),s=(e.clientX-n.left)/n.width;this.audio.currentTime=this.audio.duration*s}},updateVolume:function(){this.hideVolumeSlider=!1,this.audio.volume=this.volumeValue/100,this.volumeValue/100>0&&(this.isMuted=this.audio.muted=!1),this.volumeValue/100===0&&(this.isMuted=this.audio.muted=!0)},toggleVolume:function(){this.hideVolumeSlider=!0},stop:function(){this.playing=!1,this.paused=!0,this.audio.pause(),this.audio.currentTime=0},play:function(){this.playing&&!this.paused||(this.paused=!1,this.audio.play(),this.playing=!0)},pause:function(){this.paused=!this.paused,this.paused?this.audio.pause():this.audio.play()},changeLoop:function(){this.innerLoop=!this.innerLoop},download:function(){this.stop(),window.open(this.file,"download")},mute:function(){this.isMuted=!this.isMuted,this.audio.muted=this.isMuted,this.volumeValue=this.isMuted?0:75},_computeDuration:function(){this.audio.readyState>=2&&this.audio.duration!=1/0&&(this.totalDuration=this.audio.duration)},_handleLoaded:function(){if(!(this.audio.readyState>=2))throw new Error("Failed to load sound file");this.autoPlay&&this.play(),this.loaded=!0},_handlePlayingUI:function(e){var t=this.audio.currentTime,n=t/this.totalDuration*100;this.progressStyle="width:".concat(n,"%;"),this.currentTime=Le(t)},_handlePlayPause:function(e){"pause"===e.type&&!1===this.paused&&!1===this.playing&&(this.progressStyle="width:0%;",this.currentTime="00:00",this.paused=!0)},init:function(){this.audio.addEventListener("timeupdate",this._handlePlayingUI),this.audio.addEventListener("loadeddata",this._handleLoaded),this.audio.addEventListener("loadeddata",this._computeDuration),this.audio.addEventListener("durationchange",this._computeDuration),this.audio.addEventListener("pause",this._handlePlayPause),this.audio.addEventListener("play",this._handlePlayPause)},getAudio:function(){return this.$el.querySelectorAll("audio")[0]}},mounted:function(){console.log("mounted"),this.uuid=Te(),this.audio=this.getAudio(),this.innerLoop=this.loop,this.init()},beforeDestroy:function(){this.audio.removeEventListener("timeupdate",this._handlePlayingUI),this.audio.removeEventListener("loadeddata",this._handleLoaded),this.audio.removeEventListener("loadeddata",this._computeDuration),this.audio.removeEventListener("durationchange",this._computeDuration),this.audio.removeEventListener("pause",this._handlePlayPause),this.audio.removeEventListener("play",this._handlePlayPause)}},Oe=Ae,$e=(n("af4d"),Object(p["a"])(Oe,je,ke,!1,null,"7ef45ec8",null)),Ee=$e.exports,De=n("7e24"),Ie={components:{VueAudio:Ee},data:function(){return{selectedSoundData:null,noSoundFile:!1,useCustomAudioPlayer:!1}},computed:{selectedSound:function(){return this.$store.getters["sounds/getSelectedSound"]},labels:function(){return this.$store.getters["sounds/getLabels"]}},watch:{selectedSound:function(e){var t=this;this.selectedSoundData=null,null!=e&&(e.noSoundFile?this.noSoundFile=!0:this.$store.dispatch("sounds/loadSoundFile",e).then((function(e){return t.selectedSoundData=e})).catch((function(e){console.log(e),t.selectedSoundData=null})))}},methods:{saveSounds:function(){this.$store.dispatch("sounds/saveSounds")},spectrogramImage:function(e){return De["a"].createImageFromSpectrogram(e)}}},Re=Ie,Fe=(n("9bcd"),Object(p["a"])(Re,we,Se,!1,null,"68b80bff",null)),ze=Fe.exports,Be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"top-tabs"},e._l(e.tabs,(function(t,s){return n("div",{key:s,class:["tab",e.$route.name==t?"active":"inactive"],on:{click:function(n){e.$route.name!=t&&e.$router.push({name:t})}}},[e._v(" "+e._s(t)+" ")])})),0)},Ue=[],We={data:function(){return{tabs:["Sounds","Preprocess","Models"]}}},qe=We,Ne=(n("9292"),Object(p["a"])(qe,Be,Ue,!1,null,"f11c419c",null)),Ve=Ne.exports,Ye={name:"Sounds",components:{VerticalSplit:E,Browser:_e,SoundInspector:ze,TopTabs:Ve}},He=Ye,Je=(n("bb4f"),Object(p["a"])(He,x,P,!1,null,"b22fd59a",null)),Qe=Je.exports,Ge=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"preprocess-view"},[n("top-tabs"),n("div",{staticClass:"box text-center"},[n("div",{staticClass:"btn",on:{click:e.preprocessAll}},[e._v("preprocess all")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.overwrite,expression:"overwrite"}],attrs:{id:"overwrite_check",type:"checkbox"},domProps:{checked:Array.isArray(e.overwrite)?e._i(e.overwrite,null)>-1:e.overwrite},on:{change:function(t){var n=e.overwrite,s=t.target,o=!!s.checked;if(Array.isArray(n)){var a=null,r=e._i(n,a);s.checked?r<0&&(e.overwrite=n.concat([a])):r>-1&&(e.overwrite=n.slice(0,r).concat(n.slice(r+1)))}else e.overwrite=o}}}),n("label",{attrs:{for:"overwrite_check"}},[e._v("Overwrite existing")])]),e.batchOutput&&e.batchOutput.length>0?[n("div",{staticClass:"preprocess-output-holder box"},[n("terminal",{staticClass:"preprocess-output",attrs:{output:e.batchOutput}}),n("div",{staticClass:"btn",on:{click:e.stopPreprocessAll}},[e._v("stop")])],1)]:[n("preprocess-item",{staticClass:"preprocess-item",attrs:{sound:e.sound}})]],2)},Xe=[],Ke=(n("96cf"),n("1da1")),Ze=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"preprocess-item box h-100"},[n("div",{staticClass:"btn btn-sm back-btn ",on:{click:function(t){return e.$router.back()}}},[e._v("back")]),e.sound?[e.audioSource||e.noSoundFile?[e.audioSource?n("div",{staticClass:"audio-preview"},[n("div",{attrs:{clas:"preprocess-item-sound-name"}},[e._v(" "+e._s(e.sound.name)+" ")]),n("div",{attrs:{clas:"preprocess-item-sound-datetime"}},[e._v(" "+e._s(e.sound.datetime)+" ")]),n("audio",{ref:"audio",attrs:{controls:"",preload:"auto",src:e.audioSource}})]):e._e(),e.noSoundFile||e.sound.spectrograms&&0!=e.sound.spectrograms.length?[n("div",{staticClass:"spectrograms-info"},[e._v(" "+e._s(e.sound.spectrograms.length)+" spectrograms ("+e._s(4*e.sound.spectrograms.length)+" s) ")]),n("div",{staticClass:"spectrograms-holder"},e._l(e.sound.spectrograms,(function(t,s){return n("img",{key:s,attrs:{src:e.spectrogramImage(t)}})})),0),e.noSoundFile?e._e():n("div",{staticClass:"btn",on:{click:e.preprocessSoundBtn}},[e._v(" preprocess again ")])]:[n("div",{staticClass:"btn",on:{click:e.preprocessSoundBtn}},[e._v("preprocess")])]]:[e._v(" loading sound... ")]]:[e._v(" Select a sound in the "),n("router-link",{attrs:{to:"/sounds"}},[e._v("sounds")]),e._v(" window to preprocess ")]],2)},et=[],tt={props:{sound:{type:Object,default:null}},data:function(){return{audioSource:null,noSoundFile:!1,spectrograms:[]}},watch:{sound:function(e,t){e!=t&&this.loadSound()}},mounted:function(){var e=this;this.loadSound(this.sound).then((function(t){e.audioSource=t})).catch((function(e){return console.log(e)}))},methods:{preprocessSoundBtn:function(){this.preprocessSound(this.audioSource,this.sound).catch((function(e){return alert(e)}))},loadSound:function(e){var t=this;return new Promise((function(n,s){null==e?s(new Error("no sound selected")):e.noSoundFile?t.noSoundFile=!0:t.$store.dispatch("sounds/loadSoundFile",e).then((function(e){return n(e)}))}))},preprocessSound:function(e,t){var n=this;return new Promise((function(s,o){e?(n.$set(t,"spectrograms",null),K.dataURIToAudioBuffer(e).then((function(e){var o,a;try{o=K.analyzeSpectrogram(e),a=De["a"].padAndCut(o)}catch(r){alert(r)}n.$set(t,"spectrograms",a),n.$store.dispatch("sounds/saveSounds"),s(a)})).catch((function(e){return o(e)}))):o(new Error("no audioSource"))}))},spectrogramImage:function(e){return De["a"].createImageFromSpectrogram(e)}}},nt=tt,st=(n("e30e"),Object(p["a"])(nt,Ze,et,!1,null,"125df713",null)),ot=st.exports,at=n("7ad4"),rt={components:{PreprocessItem:ot,Terminal:at["a"],TopTabs:Ve},data:function(){return{batchOutput:[],preprocessAllStopped:!1,overwrite:!1}},computed:{sound:function(){return this.$store.getters["sounds/getSelectedSound"]}},methods:{sleep:function(e){return new Promise((function(t){return setTimeout(t,e)}))},preprocessAll:function(){var e=this;return Object(Ke["a"])(regeneratorRuntime.mark((function t(){var n,s,o,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.preprocessAllStopped=!1,e.batchOutput=["Preprocessing all unpreprocessed sounds...\n\n"],n=e.$store.getters["sounds/getAllSounds"],s=0;case 4:if(!(s<n.length)){t.next=26;break}if(o=n[s],!(o.spectrograms&&o.spectrograms.length>0)||e.overwrite){t.next=12;break}return e.batchOutput.push("(".concat(s+1,"/").concat(n.length,") ").concat(o.name," - already processed, ").concat(o.spectrograms.length," spectrograms.")),t.next=10,e.sleep(100);case 10:t.next=21;break;case 12:return t.next=14,e.loadSound(o);case 14:return a=t.sent,t.next=17,e.preprocessSound(a,o);case 17:return r=t.sent,e.batchOutput.push("(".concat(s+1,"/").concat(n.length,") ").concat(o.name," - processed : got ").concat(r.length," spectrograms.")),t.next=21,e.sleep(100);case 21:if(!e.preprocessAllStopped){t.next=23;break}return t.abrupt("break",26);case 23:s++,t.next=4;break;case 26:case"end":return t.stop()}}),t)})))()},loadSound:function(e){var t=this;return new Promise((function(n,s){null==e?s(new Error("no sound selected")):t.$store.dispatch("sounds/loadSoundFile",e).then((function(e){return n(e)}))}))},preprocessSound:function(e,t){var n=this;return new Promise((function(s,o){e?(n.$set(t,"spectrograms",null),K.dataURIToAudioBuffer(e).then((function(e){var o=K.analyzeSpectrogram(e),a=De["a"].padAndCut(o);n.$set(t,"spectrograms",a),n.$store.dispatch("sounds/saveSounds"),s(a)})).catch((function(e){return o(e)}))):o(new Error("no audioSource"))}))},stopPreprocessAll:function(){this.preprocessAllStopped=!0,this.batchOutput=[]}}},it=rt,ct=(n("0ee9"),Object(p["a"])(it,Ge,Xe,!1,null,null,null)),lt=ct.exports,ut=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"models"},[n("top-tabs"),n("div",{staticClass:"vertical-split-holder"},[n("vertical-split",{attrs:{fraction:.4},scopedSlots:e._u([{key:"top",fn:function(){return[n("div",{staticClass:"model-list text-left box h-100"},[n("item-list",{attrs:{items:e.models,"selected-item":e.selectedModel},on:{select:e.selectModel,delete:e.deleteModel}}),n("div",{staticClass:"models-bottom-btns"},[n("div",{staticClass:"btn btn-sm",on:{click:e.newModel}},[e._v("New model")])])],1)]},proxy:!0},{key:"bottom",fn:function(){return[n("div",{staticClass:"model-inspector box h-100"},[e.selectedModel?[n("div",{staticClass:"model-property"},[n("span",{staticClass:"model-property-label"},[e._v("Name")]),e._v(" "+e._s(e.selectedModel.name)+" ")]),n("div",{staticClass:"model-property"},[n("span",{staticClass:"model-property-label"},[e._v("Created")]),e._v(" "+e._s(e.selectedModel.created)+" ")]),n("select-multiple",{staticClass:"select-labels",attrs:{label:e.modelIsCreated?"Model created with labels":"Select at least 2 labels",items:e.modelIsCreated?e.labelsToObjects(e.selectedModel.labels):e.labelObjects,adjustable:!e.modelIsCreated,selected:e.selectedModel.labels},on:{change:e.selectLabels}}),n("div"),e.canCreateModel?[n("div",{staticClass:"btn mar-bottom-sm",on:{click:e.createTfModel}},[e._v(" Create model ")]),n("div",{staticClass:"btn mar-bottom-sm",on:{click:function(t){return e.deleteModel(e.selectedModel)}}},[e._v(" delete ")])]:e.modelIsCreated?n("div",{staticClass:"model-info"},[n("div",{staticClass:"msg"},[e._v("Model created.")]),e.selectedModelHasUnprocessedSounds?[n("div",{staticClass:"msg"},[e._v(" Warning: labels contain unprocessed sounds. ")]),n("div",{staticClass:"btn",on:{click:function(t){return e.$router.push("preprocess")}}},[e._v(" preprocess ")]),n("div",{staticClass:"msg"})]:e._e(),e.selectedModel.trained?n("div",{staticClass:"msg"},[e._v(" "+e._s(e.selectedModel.epochsTrained)+" epochs trained, acc: "+e._s(e.selectedModel.acc)+", loss: "+e._s(e.selectedModel.loss)+" ")]):e._e(),n("div",{staticClass:"btn mar-bottom-sm",on:{click:function(t){e.showTrainPopup=!0}}},[e._v(" train ")]),e.showTrainPopup&&e.modelIsCreated?n("train-model",{attrs:{model:e.selectedModel},on:{close:function(t){e.showTrainPopup=!1}}}):e._e(),e.selectedModel.trained?n("div",{staticClass:"btn mar-bottom-sm",on:{click:function(t){e.showEvaluatePopup=!0}}},[e._v(" evaluate ")]):e._e(),e.showEvaluatePopup&&e.selectedModel&&e.selectedModel.trained?n("evaluate-model",{attrs:{model:e.selectedModel},on:{close:function(t){e.showEvaluatePopup=!1}}}):e._e(),e.selectedModel.trained?n("div",{staticClass:"btn mar-bottom-sm",on:{click:function(t){e.showPredictPopup=!0}}},[e._v(" predict ")]):e._e(),e.showPredictPopup&&e.selectedModel&&e.selectedModel.trained?n("predict-model",{attrs:{model:e.selectedModel},on:{close:function(t){e.showPredictPopup=!1}}}):e._e(),n("div",{staticClass:"btn mar-bottom-sm",on:{click:function(t){return e.deleteModel(e.selectedModel)}}},[e._v(" delete ")])],2):n("div",{staticClass:"btn mar-bottom-sm",on:{click:function(t){return e.deleteModel(e.selectedModel)}}},[e._v(" delete ")])]:e._e()],2)]},proxy:!0}])})],1)],1)},dt=[],pt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:["select-multiple",e.adjustable?"adjustable":"static"]},[e.label&&""!=e.label?n("div",{staticClass:"select-multiple-label"},[e._v(" "+e._s(e.label)+" "),n("span",{staticClass:"op-50"},[e._v("("+e._s(e.localSelected.length)+"/"+e._s(e.items.length)+")")])]):e._e(),e._l(e.items,(function(t,s){return n("div",{key:s,class:["select-multiple-item",e.isSelected(t)?"selected":""],on:{click:function(n){return e.toggle(t)}}},[e._v(" "+e._s(t[e.displayProperty])+" ")])}))],2)},ft=[],ht=(n("45fc"),{props:{items:{type:Array,default:function(){return[]}},displayProperty:{type:String,default:"name"},selected:{type:Array,default:function(){return[]}},label:{type:String,default:""},adjustable:{type:Boolean,default:!0}},data:function(){return{localSelected:this.selected}},watch:{selected:function(e){this.localSelected=e}},methods:{isSelected:function(e){return this.localSelected.some((function(t){return e.value==t}))},toggle:function(e){this.adjustable&&(this.isSelected(e)?this.localSelected=this.localSelected.filter((function(t){return t!=e.value})):this.localSelected.push(e.value),this.$emit("change",this.localSelected))}}}),mt=ht,vt=(n("fc56"),Object(p["a"])(mt,pt,ft,!1,null,"d39ab648",null)),bt=vt.exports,gt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"train-model popup"},[n("div",{staticClass:"train-model-content"},[n("div",{staticClass:"train-model-title b"},[e._v("train model "+e._s(e.model.name))]),n("div",{staticClass:"msg"},[e._v(" Model will keep training indefinitely, saving after every "+e._s(e.epochsPerIteration)+" epochs if the loss decreased. ")]),n("div",{staticClass:"msg"},[e._v(" Click quit to stop training. ")]),n("terminal",{staticClass:"train-model-output-holder",attrs:{output:e.output}}),n("div",{staticClass:"btn",on:{click:e.quit}},[e._v("quit")])],1)])},yt=[],_t=(n("a15b"),n("13d5"),n("0b53")),wt={getModel:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:173,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:40,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=_t["e"]();return o.add(_t["b"].conv2d({inputShape:[t,n,s],kernelSize:5,filters:32,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),o.add(_t["b"].maxPooling2d({poolSize:[2,2],strides:[2,2]})),o.add(_t["b"].conv2d({kernelSize:3,filters:32,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),o.add(_t["b"].maxPooling2d({poolSize:[2,2],strides:[2,2]})),o.add(_t["b"].conv2d({kernelSize:3,filters:64,strides:1,activation:"relu",kernelInitializer:"varianceScaling"})),o.add(_t["b"].maxPooling2d({poolSize:[4,4],strides:[4,4]})),o.add(_t["b"].flatten()),o.add(_t["b"].dense({units:64,kernelInitializer:"glorotUniform",activation:"relu"})),o.add(_t["b"].dropout({rate:.5})),o.add(_t["b"].dense({units:e,kernelInitializer:"glorotUniform",activation:"sigmoid"})),o},compile:function(e){var t=_t["i"].rmsprop(.001);return e.compile({optimizer:t,loss:"categoricalCrossentropy",metrics:["accuracy"]}),e},getModelSummary:function(e){var t=[];return e.summary(60,null,(function(e){return t.push(e)})),t},prepareData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:173,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:40,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=e.map((function(e){return e.label})),a=o.length,r=[],i=[];e.forEach((function(e){var t=e.label,n=e.spectrograms,s=o.indexOf(t);n.forEach((function(e){i.push(s),r.push(e)}))}));var c=r.length,l=_t["h"](r).reshape([c,t,n,s]),u=_t["d"](_t["g"](i,"int32"),a);return{trainX:l,trainY:u}},train:function(e,t){var n=t.trainX,s=t.trainY,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:32;return e.fit(n,s,{batchSize:r,epochs:o,verbose:1,shuffle:!0,callbacks:a,validationSplit:.1,yieldEvery:75})},evaluate:function(e,t,n){var s=this;return Object(Ke["a"])(regeneratorRuntime.mark((function o(){var a,r,i,c,l,u,d,p,f;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return a=t.trainX,r=t.trainY,i=e.predict(a),o.next=4,i.array();case 4:return c=o.sent,o.next=7,r.array();case 7:for(l=o.sent,u=n.map((function(e){return n.map((function(t){return{trueLabel:e,predictedLabel:t,count:0}}))})),d=0;d<c.length;d++)p=s.argMax(c[d]),f=s.argMax(l[d]),u[f][p].count+=1;return o.abrupt("return",u);case 11:case"end":return o.stop()}}),o)})))()},argMax:function(e){return e.map((function(e,t){return[e,t]})).reduce((function(e,t){return t[0]>e[0]?t:e}))[1]},predictSpectrogram:function(e,t){var n=_t["f"](t).reshape([1,t.length,t[0].length,1]),s=e.predict(n);return s.arraySync()[0]},scoresToLabelInfo:function(e,t){var n=e.reduce((function(e,t,n,s){return t>s[e]?n:e}),0);return{predictedLabel:t[n],predictedScore:e[n],scores:e.map((function(e,n){return{label:t[n],score:e}}))}},formatPercentage:function(e){return Math.round(100*e)},formatLabelInfo:function(e){var t=this;return"\nPredicted label: ".concat(e.predictedLabel," (").concat(this.formatPercentage(e.predictedScore),"%)\n\n")+e.scores.map((function(e){var n=e.label,s=e.score;return"".concat(n,": ").concat(t.formatPercentage(s)," %")})).join("\n")}},St={components:{Terminal:at["a"]},props:{model:{type:Object,default:null}},data:function(){return{output:[],hasQuit:!1,epochsPerIteration:4}},mounted:function(){var e=this;if(this.model&&this.model.hasTfModel){this.output.push("Loading data...");var t=this.model.labels.map((function(t){return{label:t,sounds:e.$store.getters["sounds/getSoundsByLabel"](t)}})),n=0,s=[],o=[],a=0;if(t.forEach((function(e){var t=e.label,r=e.sounds,i={label:t,spectrograms:[]};r.forEach((function(e){var t;e.spectrograms&&e.spectrograms.length>0?(n+=e.spectrograms.length,(t=i.spectrograms).push.apply(t,Object(F["a"])(e.spectrograms))):a+=1})),0==i.spectrograms.length&&o.push(t),s.push(i)})),a>0&&!window.confirm("Warning: ".concat(a," sounds are not processed yet. Continue training?")))this.output.push("Training aborted.");else if(o.length>0){var r=o.join(", ");this.output.push("Error: labels (".concat(r,") contain no preprocessed sounds."))}else{this.output.push("Got ".concat(n," spectrograms in ").concat(s.length," labels:")),s.forEach((function(t){var n=t.label,s=t.spectrograms;return e.output.push("  ".concat(n,": ").concat(s.length))}));var i=wt.prepareData(s);this.output.push("Loading tensorflow model..."),this.$store.dispatch("models/loadTfModel",{model:this.model}).then((function(t){var n;t=wt.compile(t),e.output.push("Model ready:"),(n=e.output).push.apply(n,Object(F["a"])(wt.getModelSummary(t))),e.trainEpochs(t,i)})).catch((function(t){e.output.push("Encountered an error, check the console."),console.log(t)}))}}else this.output.push("No tensorflow model.")},methods:{trainEpochs:function(e,t){var n=this;return Object(Ke["a"])(regeneratorRuntime.mark((function s(){var o,a,r,i,c;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:o=n.model.loss||1e6;case 1:if(!n.hasQuit){s.next=4;break}return s.abrupt("break",24);case 4:return n.output.push("Training epochs ".concat(n.model.epochsTrained+1,"-").concat(n.model.epochsTrained+n.epochsPerIteration,"...")),s.next=7,wt.train(e,t,n.epochsPerIteration,{onEpochEnd:function(e,t){n.output.push("Epoch ".concat(e+n.model.epochsTrained+1,": loss: ").concat(t.loss,", acc: ").concat(t.acc,"."))}});case 7:if(a=s.sent,r=a.history.loss.length-1,i=a.history.loss[r],c=a.history.acc[r],!(i<o)){s.next=21;break}return n.output.push("loss decreased, saving..."),n.model.trained=!0,n.model.epochsTrained=n.model.epochsTrained?n.model.epochsTrained+n.epochsPerIteration:n.epochsPerIteration,n.model.loss=i,n.model.acc=c,s.next=19,n.$store.dispatch("models/saveModels");case 19:return s.next=21,n.$store.dispatch("models/saveTfModel",{model:n.model,tfModel:e});case 21:o=Math.min(o,i),s.next=1;break;case 24:n.output.push("Training done.");case 25:case"end":return s.stop()}}),s)})))()},quit:function(){this.hasQuit=!0,this.$emit("close")}}},jt=St,kt=(n("e846"),Object(p["a"])(jt,gt,yt,!1,null,null,null)),Mt=kt.exports,Ct=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"evaluate-model popup"},[n("div",{staticClass:"evaluate-model-content"},[n("div",{staticClass:"evaluate-model-title b"},[e._v("evaluate model "+e._s(e.model.name))]),e.confusionMatrix?n("div",{staticClass:"confusion-matrix-holder"},[n("table",{staticClass:"confusion-matrix"},[n("div",{staticClass:"msg"},[e._v(" Confusion matrix (vertical axis: true labels, horizontal axis: predicted labels) ")]),n("tr",[n("th"),e._l(e.model.labels,(function(t,s){return n("th",{key:s,staticClass:"b"},[e._v(" "+e._s(t)+" ")])}))],2),e._l(e.confusionMatrix,(function(t,s){return n("tr",{key:s},[n("td",{staticClass:"b"},[e._v(e._s(e.usedLabelDisplay(t[0].trueLabel)))]),e._l(t,(function(s,o){return n("td",{key:o,style:e.celStyle(s,t)},[e._v(" "+e._s(s.count)+" ("+e._s(e.percentage(s,t))+" %) ")])}))],2)}))],2)]):e._e(),e.started?n("div",[n("terminal",{staticClass:"evaluate-model-output-holder",attrs:{output:e.output}})],1):n("div",[e._v(" Select labels to use: "),e._l(e.model.labels,(function(t,s){return n("div",{key:s,staticClass:"msg"},[e._v(" For label "+e._s(t)+" use "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.labelMappings[t],expression:"labelMappings[label]"}],on:{change:function(n){var s=Array.prototype.filter.call(n.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.labelMappings,t,n.target.multiple?s:s[0])}}},e._l(e.allLabels,(function(t,s){return n("option",{key:s,domProps:{value:t}},[e._v(e._s(t))])})),0)])})),n("div",{staticClass:"btn",on:{click:e.start}},[e._v("Start")])],2),n("div",{staticClass:"btn",on:{click:e.quit}},[e._v("quit")])])])},xt=[],Pt={components:{Terminal:at["a"]},props:{model:{type:Object,default:null}},data:function(){return{output:[],hasQuit:!1,confusionMatrix:null,started:!1,labelMappings:{}}},mounted:function(){var e=this;this.labelMappings=this.model.labels.reduce((function(t,n){return t[n]=e.allLabels.find((function(e){return e==n}))||e.allLabels[0],t}),{})},computed:{allLabels:function(){return this.$store.getters["sounds/getLabels"]}},methods:{usedLabelDisplay:function(e){var t=this.labelMappings[e];return e==t?e:"".concat(e," (").concat(t,")")},start:function(){var e=this;if(this.started=!0,this.model&&this.model.hasTfModel){this.output.push("Loading data...");var t=this.model.labels.map((function(t){return{label:e.usedLabelDisplay(t),sounds:e.$store.getters["sounds/getSoundsByLabel"](e.labelMappings[t])}})),n=0,s=[],o=[];if(t.forEach((function(e){var t=e.label,a=e.sounds,r={label:t,spectrograms:[]};a.forEach((function(e){var t;e.spectrograms&&e.spectrograms.length>0&&(n+=e.spectrograms.length,(t=r.spectrograms).push.apply(t,Object(F["a"])(e.spectrograms)))})),0==r.spectrograms.length&&o.push(t),s.push(r)})),o.length>0){var a=o.join(", ");this.output.push("Warning: labels (".concat(a,") contain no preprocessed sounds."))}this.output.push("Got ".concat(n," spectrograms in ").concat(s.length," labels:")),s.forEach((function(t){var n=t.label,s=t.spectrograms;return e.output.push("  ".concat(n,": ").concat(s.length))}));var r=wt.prepareData(s);this.output.push("Loading tensorflow model..."),this.$store.dispatch("models/loadTfModel",{model:this.model}).then((function(t){var n;t=wt.compile(t),e.output.push("Model ready:"),(n=e.output).push.apply(n,Object(F["a"])(wt.getModelSummary(t))),e.evaluate(t,r,e.model.labels)})).catch((function(t){e.output.push("Encountered an error, check the console."),console.log(t)}))}else this.output.push("No tensorflow model.")},evaluate:function(e,t,n){var s=this;return Object(Ke["a"])(regeneratorRuntime.mark((function o(){return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.next=2,wt.evaluate(e,t,n);case 2:s.confusionMatrix=o.sent,console.log(s.confusionMatrix);case 4:case"end":return o.stop()}}),o)})))()},percentage:function(e,t){return Math.round(e.count/this.rowTotal(t)*100)},rowTotal:function(e){return e.reduce((function(e,t){return e+t.count}),0)},celStyle:function(e,t){var n=this.percentage(e,t)/100;return{backgroundColor:"rgba(94, 97, 135, ".concat(n,")"),color:n>.5?"#fff":"#000"}},quit:function(){this.hasQuit=!0,this.$emit("close")}}},Tt=Pt,Lt=(n("2453"),Object(p["a"])(Tt,Ct,xt,!1,null,"379a36e6",null)),At=Lt.exports,Ot=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"predict-model popup"},[n("div",{staticClass:"predict-model-content"},[n("div",{staticClass:"predict-model-title b"},[e._v(' use model "'+e._s(e.model.name)+'" for prediction ')]),n("terminal",{staticClass:"predict-model-output-holder",attrs:{output:e.output}}),e.modelReady?n("upload-sound-button",{attrs:{multiple:!1,"return-data-url":!1,"btn-class":"btn"},on:{sound:e.preprocessFile}}):e._e(),e.recordingSupported?[e.recording?n("div",{staticClass:"btn",on:{click:e.stopRecording}},[e._v("stop")]):n("div",{staticClass:"btn",on:{click:e.record}},[e._v("record")])]:e._e(),n("div",{staticClass:"btn",on:{click:e.quit}},[e._v("quit")]),e._m(0),n("input",{directives:[{name:"model",rawName:"v-model",value:e.postRequestUrl,expression:"postRequestUrl"}],staticClass:"predict-model-input",attrs:{placeholder:"https://localhost"},domProps:{value:e.postRequestUrl},on:{input:function(t){t.target.composing||(e.postRequestUrl=t.target.value)}}})],2)])},$t=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"msg"},[n("br"),e._v(" Optional: type an url below and every prediction will be sent to it with a post request. ")])}],Et={components:{UploadSoundButton:V,Terminal:at["a"]},props:{model:{type:Object,default:null}},data:function(){return{output:[],hasQuit:!1,hasStopped:!1,modelReady:!1,tfModel:null,recordingSupported:!1,recording:!1,recorder:null,postRequestUrl:""}},computed:{},watch:{},mounted:function(){var e=this;this.model&&this.model.hasTfModel?(this.output.push("Loading tensorflow model..."),this.$store.dispatch("models/loadTfModel",{model:this.model}).then((function(t){e.tfModel=t,e.output.push("Model ready."),e.modelReady=!0,K.getRecorder().then((function(t){e.recordingSupported=!0,e.recorder=new Z["a"](t),e.output.push("Audio recorder ready."),e.recorder.addEventListener("dataavailable",e.processRecording)})).catch((function(t){e.recordingSupported=!1,e.output.push("Recording sound is not supported in this browser or permission denied. (Error: ".concat(t.message,")"))}))})).catch((function(t){e.output.push("Encountered an error, check the console."),console.log(t)}))):this.output.push("No tensorflow model.")},methods:{processRecording:function(e){this.output.push("stop recording."),this.hasQuit||this.hasStopped||this.preprocessFile(e.data,!0)},sleep:function(e){return new Promise((function(t){return setTimeout(t,e)}))},recordWhenReady:function(){var e=this;return Object(Ke["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.hasQuit||e.hasStopped){t.next=8;break}return t.next=3,e.sleep(200);case 3:if("recording"==e.recorder.state){t.next=6;break}return e.record(),t.abrupt("break",8);case 6:t.next=0;break;case 8:case"end":return t.stop()}}),t)})))()},record:function(){var e=this;this.hasStopped=!1,this.recording=!0,this.output.push("start recording..."),this.recorder.start(),window.setTimeout((function(){"recording"==e.recorder.state&&(e.recorder.stop(),e.recordWhenReady())}),4100)},stopRecording:function(){this.hasStopped=!0,"recording"==this.recorder.state&&this.recorder.stop(),this.recording=!1},preprocessFile:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.output.push("Reading uploaded file..."),K.fileToAudioBuffer(e).then((function(e){var s,o;t.output.push("Creating spectrograms...");try{s=K.analyzeSpectrogram(e),o=De["a"].padAndCut(s)}catch(a){t.output.push("Error ceating spectrograms: ".concat(a.message))}n?(t.output.push(o[0]),t.predict(o[0])):(t.output.push("Got ".concat(o.length," spectrograms:")),o.forEach((function(e){t.output.push(e),t.predict(e)})))})).catch((function(e){return t.output.push("Error reading file: ".concat(e.message))}))},predict:function(e){if(this.modelReady){var t=wt.predictSpectrogram(this.tfModel,e),n=wt.scoresToLabelInfo(t,this.model.labels);this.output.push(wt.formatLabelInfo(n)),this.postRequestUrl&&this.sendPostRequest(n)}},sendPostRequest:function(e){var t=this;this.output.push("\nSending prediction data...");var n=new XMLHttpRequest;n.open("POST",this.postRequestUrl),n.onload=function(){n.status>=200&&n.status<300?t.output.push("Data sent. Response: ".concat(n.responseText,"\n")):t.output.push("Status: ".concat(n.status,", statusText: ").concat(n.statusText,"\n"))},n.onerror=function(){t.output.push("Request error.\n")},n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send(JSON.stringify({data:e}))},quit:function(){this.stopRecording(),this.hasQuit=!0,this.recorder.stream.getTracks().forEach((function(e){return e.stop()})),this.$emit("close")}}},Dt=Et,It=(n("789a"),Object(p["a"])(Dt,Ot,$t,!1,null,null,null)),Rt=It.exports,Ft={name:"unlabeled",value:null},zt={name:"Models",components:{VerticalSplit:E,ItemList:ve,SelectMultiple:bt,TrainModel:Mt,EvaluateModel:At,PredictModel:Rt,TopTabs:Ve},data:function(){return{selectedLabels:[],showTrainPopup:!1,showEvaluatePopup:!1,showPredictPopup:!1}},computed:{modelIsCreated:function(){return this.selectedModel&&this.selectedModel.hasTfModel},canCreateModel:function(){return this.selectedModel&&!this.modelIsCreated&&this.selectedLabels.length>1},models:function(){return this.$store.getters["models/getModels"]},selectedModel:function(){return this.$store.getters["models/getSelectedModel"]},labelObjects:function(){return[Ft].concat(Object(F["a"])(this.labelsToObjects(this.$store.getters["sounds/getLabels"])))},selectedModelHasUnprocessedSounds:function(){var e=this;if(!this.modelIsCreated&&!this.canCreateModel)return!1;var t=!1;return this.selectedModel.labels.forEach((function(n){e.$store.getters["sounds/getSoundsByLabel"](n).forEach((function(e){e.spectrograms&&0!=e.spectrograms.length||(t=!0)}))})),t}},methods:{labelsToObjects:function(e){return e.map((function(e){return{name:e,value:e}}))},objectsToLabels:function(e){return e.map((function(e){return e.value}))},newModel:function(){var e=window.prompt("New model name:");null!=e&&this.$store.commit("models/addModel",{name:e})},createTfModel:function(){var e=this;if(this.selectedModel&&this.canCreateModel){var t=wt.getModel(this.selectedLabels.length);t.summary(),this.$store.dispatch("models/saveTfModel",{model:this.selectedModel,tfModel:t}).then((function(){e.$set(e.selectedModel,"hasTfModel",!0),e.$set(e.selectedModel,"labels",e.selectedLabels),e.$store.dispatch("models/saveModels")}))}},selectModel:function(e){this.$store.commit("models/selectModel",e)},deleteModel:function(e){this.$store.dispatch("models/deleteModel",e)},selectLabels:function(e){this.selectedLabels=e}}},Bt=zt,Ut=(n("c40e"),Object(p["a"])(Bt,ut,dt,!1,null,"a85bc6ae",null)),Wt=Ut.exports,qt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"about"},[n("div",{staticClass:"view-title h4"},[e._v("About")]),e._m(0),e._m(1),e._m(2),n("p",[n("ol",[n("li",[e._v("Import or record sounds categorized by two or more different labels in the "),n("router-link",{attrs:{to:"sounds"}},[e._v("sounds tab")]),e._v(".")],1),n("li",[n("router-link",{attrs:{to:"preprocess"}},[e._v("Preprocess")]),e._v(" the sounds to generate visual spectrograms for learning.")],1),n("li",[e._v("Create and train a model in the "),n("router-link",{attrs:{to:"models"}},[e._v("models tab")]),e._v(" to predict labels for sounds. Then use the model on uploaded or recorded sounds.")],1)])]),e._m(3),e._m(4)])},Nt=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v(" Sound classification in the browser."),n("br"),e._v(" Developed by Jan Bijster for V2 institute for unstable media, Rotterdam 2020. ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("a",{attrs:{href:"https://github.com/janbijster/v2_sound_classification_js",target:"_blank"}},[e._v("View source code on Github")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("b",[e._v("Usage")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("b",[e._v("Feedback")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[e._v(" Questions, feedback, anything else? Send it to "),n("a",{attrs:{href:"mailto:info@janbijster.com"}},[e._v("info@janbijster.com")])])}],Vt=(n("e562"),{}),Yt=Object(p["a"])(Vt,qt,Nt,!1,null,"7f23b3b0",null),Ht=Yt.exports,Jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"import-export-view"},[n("div",{staticClass:"view-title h4"},[e._v("Import / Export")]),n("div",{staticClass:"box split-left text-center"},[n("h4",[e._v("Sounds")]),n("div",{staticClass:"btn",on:{click:e.exportSounds}},[e._v(" export processed sounds ")]),n("div",{staticClass:"msg"},[e._v(" (only the sound metadata and processed spectrograms are exported) ")]),n("upload-file-button",{attrs:{"btn-text":"upload processed sounds","btn-class":"btn",multiple:!1,accept:".blob"},on:{files:e.importSounds}}),n("terminal",{staticClass:"import-export-output",attrs:{output:e.output}})],1),n("div",{staticClass:"box split-right text-center"},[n("h4",[e._v("Models")]),n("upload-file-button",{attrs:{"btn-text":"import model","btn-class":"btn",multiple:!1,accept:".blob"},on:{files:e.importModel}}),n("div",{staticClass:"model-list"},e._l(e.models,(function(e,t){return n("export-model",{key:t,attrs:{model:e}})})),1)],1)])},Qt=[],Gt=n("23a2"),Xt=Gt["a"],Kt=(n("c5d7"),Object(p["a"])(Xt,Jt,Qt,!1,null,"5ee52972",null)),Zt=Kt.exports;s["a"].use(C["a"]);var en=[{path:"/",redirect:"/about"},{path:"/sounds",name:"Sounds",showInMenu:!0,component:Qe},{path:"/preprocess/",name:"Preprocess",showInMenu:!0,component:lt},{path:"/models/",name:"Models",showInMenu:!0,component:Wt},{path:"/about",name:"About",showInMenu:!0,component:Ht},{path:"/import-export",name:"Import/Export",showInMenu:!0,component:Zt}],tn=new C["a"]({routes:en}),nn=tn,sn=n("2f62"),on=(n("498a"),n("ec26")),an=(n("b64b"),n("a002")),rn=n.n(an);rn.a.ready().then((function(){rn.a.driver()!=rn.a.INDEXEDDB&&alert("Warning: IndexedDB is not available for local storage in this browser. Some components may not work.")}));var cn={diskActivity:[],hasIndexedDB:function(){return rn.a.driver()==rn.a.INDEXEDDB},storagePath:function(){return this.hasIndexedDB?"indexeddb://":"localstorage://"},saveToDisk:function(e,t){var n=this;return new Promise((function(o){s["a"].set(n.diskActivity,0,"saving ".concat(e,"...")),rn.a.setItem(e,t).then((function(){s["a"].set(n.diskActivity,0,null),o()}))}))},removeFromDisk:function(e){var t=this;s["a"].set(this.diskActivity,0,"removing ".concat(e,"...")),rn.a.removeItem(e).then((function(){return s["a"].set(t.diskActivity,0,null)})).catch((function(e){return console.log(e)}))},loadFromDisk:function(e){var t=this;return new Promise((function(n,o){s["a"].set(t.diskActivity,0,"loading ".concat(e,"...")),rn.a.getItem(e).then((function(e){s["a"].set(t.diskActivity,0,null),n(e)})).catch((function(e){s["a"].set(t.diskActivity,0,null),o(e)}))}))},saveTfModel:function(e,t){var n=this;return new Promise((function(o){s["a"].set(n.diskActivity,0,"saving model file for ".concat(e.name,"...")),t.save("".concat(n.storagePath(),"model-file-").concat(e.identifier)).then((function(){s["a"].set(n.diskActivity,0,null),o()}))}))},loadTfModel:function(e){var t=this;return new Promise((function(n,o){s["a"].set(t.diskActivity,0,"loading model file for ".concat(e.name,"...")),_t["c"]("".concat(t.storagePath(),"model-file-").concat(e.identifier)).then((function(e){s["a"].set(t.diskActivity,0,null),n(e)})).catch((function(e){s["a"].set(t.diskActivity,0,null),o(e)}))}))},clearTfModel:function(e){var t=this;s["a"].set(this.diskActivity,0,"removing model file for ".concat(e.name,"...")),_t["a"].removeModel("".concat(this.storagePath(),"model-file-").concat(e.identifier)).then((function(){return s["a"].set(t.diskActivity,0,null)})).catch((function(e){s["a"].set(t.diskActivity,0,null),console.log(e)}))},clearAllTfModels:function(){_t["a"].listModels().then((function(e){Object.keys(e).forEach((function(e){_t["a"].removeModel(e)}))}))},clearDisk:function(){var e=this;return new Promise((function(t){window.confirm("Are you sure you want to delete all sounds, labels and models?")&&(s["a"].set(e.diskActivity,0,"clearing disk..."),e.clearAllTfModels(),rn.a.clear().then((function(){s["a"].set(e.diskActivity,0,null),t()})))}))}},ln={namespaced:!0,state:{labels:[],sounds:[],selectedSound:null,diskActivity:cn.diskActivity},getters:{getLabels:function(e){return e.labels},getAllSounds:function(e){return e.sounds},getSoundsByLabel:function(e){return function(t){return e.sounds.filter((function(e){return e.label==t}))}},getSoundByIdentifier:function(e){return function(t){return e.sounds.find((function(e){return e.identifier==t}))}},getSelectedSound:function(e){return e.selectedSound},getDiskActivity:function(e){return e.diskActivity[0]}},mutations:{addLabel:function(e,t){var n=!1;e.labels.forEach((function(e){n=n||e==t})),0==n?(e.labels=[].concat(Object(F["a"])(e.labels),[t]),cn.saveToDisk("labels",e.labels)):console.log("Label already exists.")},deleteLabel:function(e,t){window.confirm("Delete label ".concat(t,"?"))&&(e.labels=e.labels.filter((function(e){return e!=t})),e.sounds=e.sounds.map((function(e){return e.label==t&&(e.label=null),e})),cn.saveToDisk("labels",e.labels).then((function(){return cn.saveToDisk("sounds",e.sounds)})))},addSound:function(e,t){var n=t.name,s=t.type,o=t.label,a=t.file,r=te()().format("YYYY-MM-DD HH:mm:ss"),i=Object(on["a"])(),c={label:o,name:n,type:s,datetime:r,identifier:i};e.sounds.push(c),e.selectedSound=c,cn.saveToDisk("sound-file-".concat(i),a).then((function(){return cn.saveToDisk("sounds",e.sounds)}))},deleteSound:function(e,t){window.confirm("Delete this sound?")&&(e.selectedSound=null,e.sounds=e.sounds.filter((function(e){return e.identifier!=t.identifier})),cn.saveToDisk("sounds",e.sounds).then((function(){return cn.removeFromDisk("sound-file-".concat(t.identifier))})))},selectSound:function(e,t){e.selectedSound=t},reset:function(e){e.labels=[],e.sounds=[],e.selectedSound=null}},actions:{newLabel:function(e){return new Promise((function(t){var n=window.prompt("New label name:");if(null!=n){var s=n.toLowerCase().trim();e.commit("addLabel",s),t(s)}else t(null)}))},importSounds:function(e,t){var n=e.state,s=e.commit,o=t.sounds,a=t.logFunction,r=void 0===a?function(e){return console.log(e)}:a;o.forEach((function(e){var t=!1;n.sounds.forEach((function(n){t=t||n.identifier==e.identifier})),t?r("Sound ".concat(e.name," already in store")):(r("Adding sound ".concat(e.name,"...")),e.noSoundFile=!0,n.sounds.push(e),e.label&&"null"!=e.label&&s("addLabel",e.label))})),cn.saveToDisk("sounds",n.sounds)},loadAll:function(e){var t=e.state;console.log("loading sounds and labels..."),cn.loadFromDisk("labels").then((function(e){null!=e&&(t.labels=e),cn.loadFromDisk("sounds").then((function(e){null!=e&&(t.sounds=e)})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))},loadSoundFile:function(e,t){return new Promise((function(e,n){cn.loadFromDisk("sound-file-".concat(t.identifier)).then((function(t){return e(t)})).catch((function(e){return n(e)}))}))},saveSounds:function(e){var t=e.state;cn.saveToDisk("sounds",t.sounds)}}},un={namespaced:!0,state:{models:[],selectedModel:null,diskActivity:cn.diskActivity},getters:{getModels:function(e){return e.models},getModelByIdentifier:function(e){return function(t){return e.models.find((function(e){return e.identifier==t}))}},getSelectedModel:function(e){return e.selectedModel},getDiskActivity:function(e){return e.diskActivity[0]}},mutations:{addModel:function(e,t){var n=te()().format("YYYY-MM-DD HH:mm:ss"),s=Object(on["a"])(),o=!1,a=[],r=Object(R["a"])({created:n,identifier:s,hasTfModel:o,labels:a},t);e.models.push(r),e.selectedModel=r,cn.saveToDisk("models",e.models)},selectModel:function(e,t){e.selectedModel=t},reset:function(e){e.models=[],e.selectedModel=null}},actions:{importModel:function(e,t){var n=e.state,s=e.dispatch,o=t.model,a=t.tfModel;n.models.push(o),cn.saveToDisk("models",n.models).then((function(){s("saveTfModel",{model:o,tfModel:a}).then((function(){cn.saveToDisk("models",n.models)}))}))},saveTfModel:function(e,t){var n=t.model,s=t.tfModel;return new Promise((function(e){cn.saveTfModel(n,s).then((function(){return e()}))}))},loadTfModel:function(e,t){var n=t.model;return new Promise((function(e,t){cn.loadTfModel(n).then((function(t){return e(t)})).catch((function(e){return t(e)}))}))},deleteModel:function(e,t){var n=e.state,s=e.commit;window.confirm("Delete model ".concat(t.name,"?"))&&(s("selectModel",null),t.hasTfModel&&cn.clearTfModel(t),n.models=n.models.filter((function(e){return e!=t})),cn.saveToDisk("models",n.models))},loadAll:function(e){var t=e.state;console.log("loading models..."),cn.loadFromDisk("models").then((function(e){null!=e&&(t.models=e)})).catch((function(e){return console.log(e)}))},saveModels:function(e){var t=e.state;return new Promise((function(e){cn.saveToDisk("models",t.models).then((function(){return e()}))}))}}};s["a"].use(sn["a"]);var dn=new sn["a"].Store({actions:{loadAll:function(e){var t=e.dispatch;t("sounds/loadAll"),t("models/loadAll")},clearAll:function(e){var t=e.commit;cn.clearDisk().then((function(){t("sounds/reset"),t("models/reset")}))}},modules:{sounds:ln,models:un}});s["a"].config.productionTip=!1,new s["a"]({router:nn,store:dn,render:function(e){return e(M)}}).$mount("#app")},"58f7":function(e,t,n){"use strict";(function(e){n("b0c0"),n("d3b7"),n("25f0"),n("96cf");var s=n("1da1"),o=n("21a6"),a=n("afc3"),r=n.n(a),i=n("0b53");t["a"]={props:{model:{type:Object,default:null}},methods:{exportModel:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r,c;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$store.dispatch("models/loadTfModel",{model:t.model});case 2:return a=n.sent,n.next=5,a.save(i["a"].withSaveHandler(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:r=n.sent,r.weightData=e.from(r.weightData).toString("base64"),c=JSON.stringify(r),t.model.tfModelJson=c,Object(o["saveAs"])(new Blob([JSON.stringify(t.model)]),"".concat(t.model.name,".blob"));case 10:case"end":return n.stop()}}),n)})))()},roundTo:r.a}}}).call(this,n("b639").Buffer)},"5c0b":function(e,t,n){"use strict";var s=n("9c0c"),o=n.n(s);o.a},"5da2":function(e,t,n){},6:function(e,t){},"629e":function(e,t,n){},"658f":function(e,t,n){"use strict";var s=n("7c83"),o=n.n(s);o.a},"684f":function(e,t,n){},"73c4":function(e,t,n){},7504:function(e,t,n){},"789a":function(e,t,n){"use strict";var s=n("f318"),o=n.n(s);o.a},"7ad4":function(e,t,n){"use strict";var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"output",staticClass:"terminal"},[n("div",{staticClass:"mono",domProps:{innerHTML:e._s(e.outputString)}}),n("div",{staticClass:"terminal-end"})])},o=[],a=(n("a15b"),n("d81d"),n("fb6a"),n("a9e3"),n("7e24")),r={props:{output:{type:Array,default:function(){return[]}},maxLines:{type:Number,default:100}},computed:{startIndex:function(){return Math.max(0,this.output.length-this.maxLines)},endIndex:function(){return Math.min(this.startIndex+this.maxLines,this.output.length)},firstLine:function(){return this.output.length>this.maxLines?"(...)\n":""},outputString:function(){return this.firstLine+this.output.slice(this.startIndex,this.endIndex).map(this.formatOutputItem).join("")}},watch:{output:function(){var e=this.$refs["output"];e.scrollTop=e.scrollHeight}},methods:{formatOutputItem:function(e){if("string"==typeof e)return"<pre>".concat(e,"</pre>");try{var t=a["a"].createImageFromSpectrogram(e);return'<img src="'.concat(t,'" />')}catch(n){return""}}}},i=r,c=(n("f58f"),n("2877")),l=Object(c["a"])(i,s,o,!1,null,null,null);t["a"]=l.exports},"7c83":function(e,t,n){},"7e24":function(e,t,n){"use strict";n("99af"),n("fb6a"),n("ace4"),n("d3b7"),n("8a59"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7");var s=n("2909");t["a"]={padAndCut:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:173,o=e.length,a=Math.round(t*n),r=n-a,i=Math.max(1,Math.ceil((o-a)/r)),c=[],l=0;l<i;l++){var u=l*r,d=u+n,p=e.slice(u,d);while(p.length<n){var f=n-p.length;p=[].concat(Object(s["a"])(p),Object(s["a"])(e.slice(0,f)))}c.push(p)}return c},createImageFromSpectrogram:function(e){for(var t=e.length,n=e[0].length,s=new Uint8ClampedArray(t*n*4),o=0;o<n;o++)for(var a=0;a<t;a++){var r=4*(o*t+a),i=255*e[a][n-o-1];s[r]=i,s[r+1]=i,s[r+2]=i,s[r+3]=255}var c=document.createElement("canvas"),l=c.getContext("2d");c.width=t,c.height=n;var u=l.createImageData(t,n);u.data.set(s),l.putImageData(u,0,0);var d=c.toDataURL();return d}}},"89e3":function(e,t,n){},"90bf":function(e,t,n){},9292:function(e,t,n){"use strict";var s=n("5da2"),o=n.n(s);o.a},9976:function(e,t,n){},"9bcd":function(e,t,n){"use strict";var s=n("567d"),o=n.n(s);o.a},"9c0c":function(e,t,n){},af4d:function(e,t,n){"use strict";var s=n("37e7"),o=n.n(s);o.a},b573:function(e,t,n){},b674:function(e,t,n){"use strict";var s=n("9976"),o=n.n(s);o.a},bb4f:function(e,t,n){"use strict";var s=n("b573"),o=n.n(s);o.a},c40e:function(e,t,n){"use strict";var s=n("2862"),o=n.n(s);o.a},c5d7:function(e,t,n){"use strict";var s=n("7504"),o=n.n(s);o.a},cbc0:function(e,t,n){"use strict";var s=n("73c4"),o=n.n(s);o.a},cedc:function(e,t,n){},cee4:function(e,t,n){},d88d:function(e,t,n){},d981:function(e,t,n){},e30e:function(e,t,n){"use strict";var s=n("cedc"),o=n.n(s);o.a},e562:function(e,t,n){"use strict";var s=n("d88d"),o=n.n(s);o.a},e846:function(e,t,n){"use strict";var s=n("f05e"),o=n.n(s);o.a},f05e:function(e,t,n){},f13a:function(e,t,n){},f318:function(e,t,n){},f58f:function(e,t,n){"use strict";var s=n("fc2c"),o=n.n(s);o.a},fb0a:function(e,t,n){"use strict";var s=n("89e3"),o=n.n(s);o.a},fc2c:function(e,t,n){},fc56:function(e,t,n){"use strict";var s=n("0e5f"),o=n.n(s);o.a}});
//# sourceMappingURL=app.6dab6ac3.js.map